Vault password (gpte_vault_0): 

PLAY [Step 0000 Set Action] ****************************************************

TASK [Set ACTION to destroy] ***************************************************
Thursday 07 August 2025  15:27:40 +0000 (0:00:00.013)       0:00:00.013 ******* 
skipping: [localhost]

PLAY [Step 0000 Setup runtime] *************************************************

TASK [debug] *******************************************************************
Thursday 07 August 2025  15:27:40 +0000 (0:00:00.029)       0:00:00.042 ******* 
skipping: [localhost]

TASK [Ensure cloud provider is supported] **************************************
Thursday 07 August 2025  15:27:40 +0000 (0:00:00.014)       0:00:00.057 ******* 
ok: [localhost] => {
    "changed": false,
    "msg": "All assertions passed"
}

PLAY [Step 0000 Setup Output Directory] ****************************************

TASK [Set output_dir if not defined] *******************************************
Thursday 07 August 2025  15:27:40 +0000 (0:00:00.025)       0:00:00.083 ******* 
skipping: [localhost]

TASK [Create output_dir if it does not exists] *********************************
Thursday 07 August 2025  15:27:40 +0000 (0:00:00.014)       0:00:00.097 ******* 
changed: [localhost]

TASK [Attempt to restore output_dir contents] **********************************
Thursday 07 August 2025  15:27:40 +0000 (0:00:00.265)       0:00:00.363 ******* 
skipping: [localhost]

TASK [Touch file provision-user-data.yaml and provision-user-info.yaml] ********
Thursday 07 August 2025  15:27:40 +0000 (0:00:00.017)       0:00:00.381 ******* 
changed: [localhost] => (item=user-info.yaml)
changed: [localhost] => (item=user-data.yaml)

TASK [Create empty user-info.yaml and user-data.yaml in output dir] ************
Thursday 07 August 2025  15:27:41 +0000 (0:00:00.350)       0:00:00.731 ******* 
changed: [localhost] => (item=user-info.yaml)
changed: [localhost] => (item=user-data.yaml)

TASK [Create symlink user-data.yaml -> provision-user-data.yaml] ***************
Thursday 07 August 2025  15:27:41 +0000 (0:00:00.833)       0:00:01.565 ******* 
changed: [localhost] => (item=user-info.yaml)
changed: [localhost] => (item=user-data.yaml)

PLAY [Step 0000 Include Vars] **************************************************

TASK [Set output_dir for all hosts] ********************************************
Thursday 07 August 2025  15:27:42 +0000 (0:00:00.362)       0:00:01.927 ******* 
ok: [localhost]

TASK [Include variables files] *************************************************
Thursday 07 August 2025  15:27:42 +0000 (0:00:00.022)       0:00:01.950 ******* 
skipping: [localhost] => (item=/runner/project/ansible/cloud_providers/azure_default_vars.yaml) 
skipping: [localhost] => (item=/runner/project/ansible/cloud_providers/azure_default_vars.yml) 
skipping: [localhost] => (item=/runner/project/ansible/configs/open-environment-azure-subscription/env_vars.yaml) 
skipping: [localhost] => (item=/runner/project/ansible/configs/open-environment-azure-subscription/env_vars.yml) 
skipping: [localhost] => (item=/runner/project/ansible/configs/open-environment-azure-subscription/default_vars.yaml) 
ok: [localhost] => (item=/runner/project/ansible/configs/open-environment-azure-subscription/default_vars.yml)
skipping: [localhost] => (item=/runner/project/ansible/configs/open-environment-azure-subscription/default_vars_azure.yaml) 
skipping: [localhost] => (item=/runner/project/ansible/configs/open-environment-azure-subscription/default_vars_azure.yml) 
skipping: [localhost] => (item=/runner/project/ansible/configs/open-environment-azure-subscription/env_secret_vars.yaml) 
skipping: [localhost] => (item=/runner/project/ansible/configs/open-environment-azure-subscription/env_secret_vars.yml) 

TASK [Include secret_file if passed as extra-var] ******************************
Thursday 07 August 2025  15:27:42 +0000 (0:00:00.076)       0:00:02.027 ******* 
skipping: [localhost]

TASK [Set passthrough user data] ***********************************************
Thursday 07 August 2025  15:27:42 +0000 (0:00:00.016)       0:00:02.044 ******* 
skipping: [localhost]

PLAY [Step 0000 Install Galaxy roles and collections] **************************

TASK [Use requirements_content] ************************************************
Thursday 07 August 2025  15:27:42 +0000 (0:00:00.029)       0:00:02.073 ******* 
skipping: [localhost]

TASK [Copy requirements content to output_dir] *********************************
Thursday 07 August 2025  15:27:42 +0000 (0:00:00.032)       0:00:02.105 ******* 
skipping: [localhost]

TASK [Use requirements_path from the config] ***********************************
Thursday 07 August 2025  15:27:42 +0000 (0:00:00.031)       0:00:02.137 ******* 
ok: [localhost]

TASK [Check if requirements.yml exists] ****************************************
Thursday 07 August 2025  15:27:42 +0000 (0:00:00.031)       0:00:02.169 ******* 
ok: [localhost]

TASK [set_fact] ****************************************************************
Thursday 07 August 2025  15:27:42 +0000 (0:00:00.167)       0:00:02.336 ******* 
ok: [localhost]

TASK [Install roles from requirements.yml] *************************************
Thursday 07 August 2025  15:27:42 +0000 (0:00:00.037)       0:00:02.373 ******* 
changed: [localhost]

TASK [Install collections from requirements.yml (Not EE)] **********************
Thursday 07 August 2025  15:27:43 +0000 (0:00:00.657)       0:00:03.030 ******* 
skipping: [localhost]

TASK [Get installed collections (EE)] ******************************************
Thursday 07 August 2025  15:27:43 +0000 (0:00:00.036)       0:00:03.067 ******* 
included: /runner/project/ansible/install_collections_ee.yml for localhost

TASK [Get the list of installed collections (EE)] ******************************
Thursday 07 August 2025  15:27:43 +0000 (0:00:00.040)       0:00:03.108 ******* 
changed: [localhost]

TASK [Create temporary file for requirements.yml (EE)] *************************
Thursday 07 August 2025  15:27:43 +0000 (0:00:00.541)       0:00:03.650 ******* 
changed: [localhost]

TASK [Rewrite requirements, filter out installed collections (EE)] *************
Thursday 07 August 2025  15:27:44 +0000 (0:00:00.265)       0:00:03.915 ******* 
[WARNING]: skipping installation of ansible.posix==1.5.4 ; ansible.posix==1.5.4
already installed in EE
[WARNING]: skipping installation of community.general==7.2.1 ;
community.general==8.6.0 already installed in EE
[WARNING]: skipping installation of kubernetes.core==2.4.0 ;
kubernetes.core==3.0.1 already installed in EE
[WARNING]: skipping installation of azure.azcollection==1.18.1 ;
azure.azcollection==2.3.0 already installed in EE
changed: [localhost]

TASK [Install collections from requirements.yml (EE)] **************************
Thursday 07 August 2025  15:27:44 +0000 (0:00:00.338)       0:00:04.254 ******* 
changed: [localhost]

TASK [Cleanup tempfile (EE)] ***************************************************
Thursday 07 August 2025  15:27:47 +0000 (0:00:02.691)       0:00:06.945 ******* 
changed: [localhost]

TASK [Install dynamic sources] *************************************************
Thursday 07 August 2025  15:27:47 +0000 (0:00:00.181)       0:00:07.126 ******* 

TASK [agnosticd_dynamic : Create dynamic-cache and dynamic-roles directories] ***
Thursday 07 August 2025  15:27:47 +0000 (0:00:00.029)       0:00:07.156 ******* 
changed: [localhost] => (item=/runner/project/ansible/dynamic-cache)
changed: [localhost] => (item=/runner/project/ansible/dynamic-roles)

TASK [agnosticd_dynamic : Install ansible-galaxy sources to dynamic roles dir] ***
Thursday 07 August 2025  15:27:47 +0000 (0:00:00.349)       0:00:07.506 ******* 
skipping: [localhost]

TASK [agnosticd_dynamic : Install ansible-galaxy sources to cache] *************
Thursday 07 August 2025  15:27:47 +0000 (0:00:00.030)       0:00:07.536 ******* 
skipping: [localhost]

TASK [agnosticd_dynamic : Install git sources] *********************************
Thursday 07 August 2025  15:27:47 +0000 (0:00:00.027)       0:00:07.564 ******* 
skipping: [localhost]

PLAY [Step 0000 Detect in what region the stack is] ****************************

TASK [include_tasks] ***********************************************************
Thursday 07 August 2025  15:27:47 +0000 (0:00:00.025)       0:00:07.589 ******* 
skipping: [localhost]

PLAY [Cleanup Azure Subscription Based Sandbox] ********************************

TASK [Run the azure remove user from subscription ROLE] ************************
Thursday 07 August 2025  15:27:47 +0000 (0:00:00.026)       0:00:07.616 ******* 

TASK [open-env-azure-remove-user-from-subscription : Log into Azure CLI] *******
Thursday 07 August 2025  15:27:47 +0000 (0:00:00.041)       0:00:07.658 ******* 
changed: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Check if email is Red Hat associate] ***
Thursday 07 August 2025  15:27:50 +0000 (0:00:02.572)       0:00:10.230 ******* 
ok: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Check if email is not a Red Hat associate] ***
Thursday 07 August 2025  15:27:50 +0000 (0:00:00.053)       0:00:10.284 ******* 
skipping: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Checking if user is in Active Directory] ***
Thursday 07 August 2025  15:27:50 +0000 (0:00:00.014)       0:00:10.299 ******* 
ok: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Remove user from group] ***
Thursday 07 August 2025  15:27:52 +0000 (0:00:02.315)       0:00:12.614 ******* 
ok: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Retrieve which Pool ID is allocated for this user from the database] ***
Thursday 07 August 2025  15:27:55 +0000 (0:00:02.903)       0:00:15.517 ******* 
ok: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Write out the assigned Pool ID] ***
Thursday 07 August 2025  15:27:56 +0000 (0:00:00.548)       0:00:16.065 ******* 
ok: [localhost] => {
    "msg": "pool-01-377"
}

TASK [open-env-azure-remove-user-from-subscription : Get facts for the subscription by name] ***
Thursday 07 August 2025  15:27:56 +0000 (0:00:00.032)       0:00:16.098 ******* 
ok: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Write out assignedsubscription] ***
Thursday 07 August 2025  15:27:57 +0000 (0:00:01.440)       0:00:17.539 ******* 
ok: [localhost] => {
    "msg": {
        "changed": false,
        "failed": false,
        "subscriptions": [
            {
                "display_name": "pool-01-377",
                "fqid": "/subscriptions/46aaa014-8207-4d58-9878-ebf020f8bb54",
                "state": "Enabled",
                "subscription_id": "46aaa014-8207-4d58-9878-ebf020f8bb54",
                "tags": {
                    "EMAIL": "shsmith@redhat.com",
                    "GUID": "4plrw",
                    "cost-center": "542"
                },
                "tenant_id": "64dc69e4-d083-49fc-9569-ebece1dd1408"
            }
        ]
    }
}

TASK [open-env-azure-remove-user-from-subscription : Get subscription ID] ******
Thursday 07 August 2025  15:27:57 +0000 (0:00:00.046)       0:00:17.585 ******* 
ok: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Switch Subscriptions] *****
Thursday 07 August 2025  15:27:57 +0000 (0:00:00.042)       0:00:17.627 ******* 
changed: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Clean up DNS zone] ********
Thursday 07 August 2025  15:27:58 +0000 (0:00:00.474)       0:00:18.102 ******* 
changed: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Delete NS record from DNS] ***
Thursday 07 August 2025  15:27:59 +0000 (0:00:01.422)       0:00:19.525 ******* 
ok: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Get all resource groups in the subscription] ***
Thursday 07 August 2025  15:28:01 +0000 (0:00:01.614)       0:00:21.139 ******* 
ok: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Write out all resource groups] ***
Thursday 07 August 2025  15:28:02 +0000 (0:00:01.396)       0:00:22.536 ******* 
ok: [localhost] => {
    "msg": {
        "changed": false,
        "failed": false,
        "resourcegroups": [
            {
                "id": "/subscriptions/46aaa014-8207-4d58-9878-ebf020f8bb54/resourceGroups/ResourceMoverRG-eastus-eastus2-eus2",
                "location": "eastus2",
                "name": "ResourceMoverRG-eastus-eastus2-eus2",
                "properties": {
                    "provisioning_state": "Succeeded"
                },
                "type": "Microsoft.Resources/resourceGroups"
            }
        ]
    }
}

TASK [open-env-azure-remove-user-from-subscription : Empty Resource Group] *****
Thursday 07 August 2025  15:28:02 +0000 (0:00:00.039)       0:00:22.576 ******* 
included: /runner/project/ansible/roles/open-env-azure-remove-user-from-subscription/tasks/empty_resource_group.yml for localhost => (item={'id': '/subscriptions/46aaa014-8207-4d58-9878-ebf020f8bb54/resourceGroups/ResourceMoverRG-eastus-eastus2-eus2', 'name': 'ResourceMoverRG-eastus-eastus2-eus2', 'type': 'Microsoft.Resources/resourceGroups', 'properties': {'provisioning_state': 'Succeeded'}, 'location': 'eastus2'})

TASK [open-env-azure-remove-user-from-subscription : Query all the resources in the resource group] ***
Thursday 07 August 2025  15:28:02 +0000 (0:00:00.045)       0:00:22.622 ******* 
ok: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Delete Recovery Service Vaults] ***
Thursday 07 August 2025  15:28:04 +0000 (0:00:01.481)       0:00:24.103 ******* 
skipping: [localhost] => (item={'id': '/subscriptions/46aaa014-8207-4d58-9878-ebf020f8bb54/resourceGroups/ResourceMoverRG-eastus-eastus2-eus2/providers/Microsoft.Migrate/moveCollections/MoveCollection-eus-eus2-eus2', 'name': 'MoveCollection-eus-eus2-eus2', 'type': 'Microsoft.Migrate/moveCollections', 'location': 'eastus2', 'identity': {'principalId': '31440f3d-65bc-46c8-a923-a41ce19e349a', 'tenantId': '64dc69e4-d083-49fc-9569-ebece1dd1408', 'type': 'SystemAssigned'}}) 
skipping: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Get list of locks in the subscription] ***
Thursday 07 August 2025  15:28:04 +0000 (0:00:00.040)       0:00:24.144 ******* 
ok: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Delete all locks in the subscription] ***
Thursday 07 August 2025  15:28:05 +0000 (0:00:01.478)       0:00:25.622 ******* 
skipping: [localhost]

TASK [open-env-azure-remove-user-from-subscription : Delete all resource groups owned by the subscription (RG's created by the lab user)] ***
Thursday 07 August 2025  15:28:05 +0000 (0:00:00.010)       0:00:25.633 ******* 
failed: [localhost] (item={'id': '/subscriptions/46aaa014-8207-4d58-9878-ebf020f8bb54/resourceGroups/ResourceMoverRG-eastus-eastus2-eus2', 'name': 'ResourceMoverRG-eastus-eastus2-eus2', 'type': 'Microsoft.Resources/resourceGroups', 'properties': {'provisioning_state': 'Succeeded'}, 'location': 'eastus2'}) => {"ansible_loop_var": "item", "changed": false, "item": {"id": "/subscriptions/46aaa014-8207-4d58-9878-ebf020f8bb54/resourceGroups/ResourceMoverRG-eastus-eastus2-eus2", "location": "eastus2", "name": "ResourceMoverRG-eastus-eastus2-eus2", "properties": {"provisioning_state": "Succeeded"}, "type": "Microsoft.Resources/resourceGroups"}, "msg": "Error delete resource group ResourceMoverRG-eastus-eastus2-eus2 - (ResourceGroupDeletionBlocked) Deletion of resource group 'ResourceMoverRG-eastus-eastus2-eus2' failed as resources with identifiers 'Microsoft.Migrate/moveCollections/MoveCollection-eus-eus2-eus2' could not be deleted. The provisioning state of the resource group will be rolled back. The tracking Id is '191feb78-417d-42b0-af88-7c327aff0554'. Please check audit logs for more details.\\nCode: ResourceGroupDeletionBlocked\\nMessage: Deletion of resource group 'ResourceMoverRG-eastus-eastus2-eus2' failed as resources with identifiers 'Microsoft.Migrate/moveCollections/MoveCollection-eus-eus2-eus2' could not be deleted. The provisioning state of the resource group will be rolled back. The tracking Id is '191feb78-417d-42b0-af88-7c327aff0554'. Please check audit logs for more details.\\nException Details:\\t(None) {\\"error\\":{\\"code\\":\\"DeleteCollectionFailedResourcesExists\\",\\"message\\":\\"Deletion of move collection is not allowed when there are move resources present in it.\\\\n      Possible Causes: The move collection has move resources present in it.\\\\n      Recommended Action: In Portal open 'Azure Resource Mover' > Across regions > Select SubscriptionId: 46aaa014-8207-4d58-9878-ebf020f8bb54, Source Region: eastus, Target Region: eastus2 > delete all the resources, and then retry deleting the Resource group.\\\\n      For PowerShell please use remove resource cmdlet and delete all resources and then try deleting move collection or resource group. Please follow documentation  https://go.microsoft.com/fwlink/?linkid=2145903.\\\\n    \\"}}\\n\\tCode: None\\n\\tMessage: {\\"error\\":{\\"code\\":\\"DeleteCollectionFailedResourcesExists\\",\\"message\\":\\"Deletion of move collection is not allowed when there are move resources present in it.\\\\n      Possible Causes: The move collection has move resources present in it.\\\\n      Recommended Action: In Portal open 'Azure Resource Mover' > Across regions > Select SubscriptionId: 46aaa014-8207-4d58-9878-ebf020f8bb54, Source Region: eastus, Target Region: eastus2 > delete all the resources, and then retry deleting the Resource group.\\\\n      For PowerShell please use remove resource cmdlet and delete all resources and then try deleting move collection or resource group. Please follow documentation  https://go.microsoft.com/fwlink/?linkid=2145903.\\\\n    \\"}}\\n\\tTarget: /subscriptions/46aaa014-8207-4d58-9878-ebf020f8bb54/resourceGroups/ResourceMoverRG-eastus-eastus2-eus2/providers/Microsoft.Migrate/moveCollections/MoveCollection-eus-eus2-eus2"}

NO MORE HOSTS LEFT *************************************************************

PLAY RECAP *********************************************************************
localhost                  : ok=35   changed=14   unreachable=0    failed=1    skipped=16   rescued=0    ignored=0   
Thursday 07 August 2025  15:34:13 +0000 (0:06:07.860)       0:06:33.494 ******* 
=============================================================================== 
open-env-azure-remove-user-from-subscription : Delete all resource groups owned by the subscription (RG's created by the lab user) - 367.86s
open-env-azure-remove-user-from-subscription : Remove user from group --- 2.90s
Install collections from requirements.yml (EE) -------------------------- 2.69s
open-env-azure-remove-user-from-subscription : Log into Azure CLI ------- 2.57s
open-env-azure-remove-user-from-subscription : Checking if user is in Active Directory --- 2.32s
open-env-azure-remove-user-from-subscription : Delete NS record from DNS --- 1.61s
open-env-azure-remove-user-from-subscription : Query all the resources in the resource group --- 1.48s
open-env-azure-remove-user-from-subscription : Get list of locks in the subscription --- 1.48s
open-env-azure-remove-user-from-subscription : Get facts for the subscription by name --- 1.44s
open-env-azure-remove-user-from-subscription : Clean up DNS zone -------- 1.42s
open-env-azure-remove-user-from-subscription : Get all resource groups in the subscription --- 1.40s
Create empty user-info.yaml and user-data.yaml in output dir ------------ 0.83s
Install roles from requirements.yml ------------------------------------- 0.66s
open-env-azure-remove-user-from-subscription : Retrieve which Pool ID is allocated for this user from the database --- 0.55s
Get the list of installed collections (EE) ------------------------------ 0.54s
open-env-azure-remove-user-from-subscription : Switch Subscriptions ----- 0.47s
Create symlink user-data.yaml -> provision-user-data.yaml --------------- 0.36s
Touch file provision-user-data.yaml and provision-user-info.yaml -------- 0.35s
agnosticd_dynamic : Create dynamic-cache and dynamic-roles directories --- 0.35s
Rewrite requirements, filter out installed collections (EE) ------------- 0.34s
